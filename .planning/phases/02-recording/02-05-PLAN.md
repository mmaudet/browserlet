---
phase: 02-recording
plan: 05
type: execute
wave: 4
depends_on: ["02-04"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can start recording from Side Panel and see REC indicator"
    - "User clicks are captured with semantic hints in the action list"
    - "User typing is captured with input values"
    - "Recording works in iframes (same-origin)"
    - "User can stop recording and see all captured actions"
  artifacts: []
  key_links: []
---

<objective>
End-to-end verification of recording functionality. Human tests the complete recording flow to confirm all Phase 2 requirements are met.

Purpose: Verify that the recording system works as designed in a real browser environment. Automated tests cannot fully validate visual feedback, iframe behavior, and UX quality.

Output: Verified recording functionality ready for Phase 3 (Side Panel UI enhancement).
</objective>

<execution_context>
@/Users/mmaudet/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mmaudet/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-recording/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build and load extension</name>
  <files></files>
  <action>
1. Build the extension:
```bash
npm run build
```

2. If build succeeds, print instructions for loading in Chrome:
```
Extension built successfully.

To load in Chrome:
1. Open chrome://extensions/
2. Enable "Developer mode" (top right toggle)
3. Click "Load unpacked"
4. Select: /Users/mmaudet/work/browserlet/.output/chrome-mv3
5. Pin the extension to toolbar
6. Click the extension icon to open Side Panel
```

3. Run a simple smoke test to verify the build:
```bash
# Check that output files exist
ls -la .output/chrome-mv3/
ls -la .output/chrome-mv3/content-scripts/
```
  </action>
  <verify>
    npm run build succeeds and .output/chrome-mv3 directory exists with manifest.json
  </verify>
  <done>
    Extension build succeeds. Output directory contains manifest.json and content scripts.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete recording system with:
- Start/Stop recording controls in Side Panel
- Visual feedback (REC indicator + hover highlighting)
- Event capture (clicks, typing, form submits)
- Navigation capture (page loads, SPA routes)
- Semantic hint generation (10 hint types)
- iframe injection (allFrames: true)
- Storage persistence of captured actions
  </what-built>

  <how-to-verify>
**Setup:**
1. Load extension from `.output/chrome-mv3` in chrome://extensions
2. Pin extension to toolbar
3. Click extension icon to open Side Panel

**Test 1: Basic Recording (REC-01, REC-02, REC-06)**
1. Click "Start Recording" in Side Panel
2. Verify: REC indicator appears in top-right of page
3. Verify: Side Panel shows "Recording" status
4. Navigate to any website (e.g., https://example.com)
5. Hover over a link - verify blue highlight appears
6. Click the link
7. Verify: Highlight flashes green briefly
8. Check Side Panel - action should appear with hints (role, text_contains, etc.)
9. Click "Stop Recording"
10. Verify: REC indicator disappears

**Test 2: Input Capture (REC-03)**
1. Start recording
2. Navigate to a site with a form (e.g., https://www.google.com)
3. Type "test query" in the search box
4. Wait 1 second (debounce)
5. Check Side Panel - input action should appear with value "test query"
6. Stop recording

**Test 3: Navigation Capture (REC-04)**
1. Start recording
2. Click a link to navigate to a new page
3. Check Side Panel - navigate action should appear with targetUrl
4. Stop recording

**Test 4: Semantic Hints Quality (REC-05)**
1. Start recording
2. Navigate to a site with good accessibility (e.g., https://github.com)
3. Click on various elements (buttons, links, inputs)
4. Check Side Panel - actions should have hints like:
   - role: "button", "link", "textbox"
   - aria_label or text_contains with actual content
   - data_attribute if element has data-testid
5. Verify: No XPath selectors, only semantic hints
6. Stop recording

**Test 5: iframe Recording (REC-07)**
1. Navigate to a page with an iframe (e.g., https://www.w3schools.com/html/html_iframe.asp)
2. Start recording
3. Click inside the iframe
4. Check Side Panel - action should appear with isIframe: true
5. Stop recording

**Test 6: Recording Persistence**
1. Start recording
2. Perform a few actions
3. Refresh the page (F5)
4. Verify: Recording continues (REC indicator reappears)
5. Check Side Panel - previous actions should still be there
6. Perform more actions
7. Stop recording
8. Verify: All actions (before and after refresh) are preserved
  </how-to-verify>

  <resume-signal>
Type "approved" if all tests pass.
If issues found, describe:
- Which test failed
- What happened vs. what was expected
- Any error messages in console (chrome://extensions -> Browserlet -> "service worker" link -> Console)
  </resume-signal>
</task>

</tasks>

<verification>
Human verification of complete recording flow covering all Phase 2 requirements:
- REC-01: Start/stop from Side Panel
- REC-02: Click capture
- REC-03: Input capture
- REC-04: Navigation capture
- REC-05: Semantic hints (not XPath)
- REC-06: Visual feedback
- REC-07: iframe support
- REC-08: Deferred to Phase 5 (LLM integration)
</verification>

<success_criteria>
1. All 6 verification tests pass
2. Recording controls work reliably
3. Visual feedback is clear and non-intrusive
4. Semantic hints are meaningful (not auto-generated IDs or XPath)
5. iframe recording works for same-origin frames
6. User approves with "approved" response
</success_criteria>

<output>
After completion, create `.planning/phases/02-recording/02-05-SUMMARY.md`
</output>
